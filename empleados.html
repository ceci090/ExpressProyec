<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Empleados</title>
    <link rel="stylesheet" href="/empleados.css">
</head>
<body>
    <header>
        <nav>
            <ul>
                <li><a href="menu.html">Inicio</a></li>
                <li><a href="nosotros.html">Nosotros</a></li>
                <li><a href="productos.html">Productos</a></li>
                <li><a href="Tienda en línea.html">Tienda en línea</a></li>
                <li><a href="empleados.html">Empleados</a></li>
                <li><a href="javascript:void(0);" onclick="handleLogout()">Cerrar sesión</a></li>
            </ul>
        </nav>
    </header>
    <div class="container">
        <h1>Gestión de Empleados</h1>
        <div>
            <input type="text" id="nombre" placeholder="Nombre del empleado" required>
            <input type="text" id="puesto" placeholder="Puesto del empleado" required>
            <button onclick="agregarEmpleado()">Agregar</button>
        </div>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Puesto</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody id="tabla-empleados">
                <!-- Aquí se insertarán los empleados -->
            </tbody>
        </table>
    </div>

    <script>
        const API_URL = "http://localhost:3001/empleados";

        // Cargar empleados desde la API
        async function cargarEmpleados() {
            try {
                const respuesta = await fetch(API_URL);
                const empleados = await respuesta.json();
                const tabla = document.getElementById("tabla-empleados");
                tabla.innerHTML = empleados.map(emp => `
                    <tr>
                        <td>${emp.id}</td>
                        <td>${emp.nombre}</td>
                        <td>${emp.puesto}</td>
                        <td>
                            <button class="edit-btn" onclick="editarEmpleado(${emp.id}, '${emp.nombre}', '${emp.puesto}')">Editar</button>
                            <button class="delete-btn" onclick="eliminarEmpleado(${emp.id})">Eliminar</button>
                        </td>
                    </tr>
                `).join("");
            } catch (error) {
                console.error("Error al cargar los empleados:", error);
            }
        }

        // Agregar empleado
        async function agregarEmpleado() {
            const nombre = document.getElementById("nombre").value;
            const puesto = document.getElementById("puesto").value;

            if (!nombre || !puesto) {
                alert("Por favor ingresa el nombre y el puesto.");
                return;
            }

            try {
                await fetch(API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ nombre, puesto })
                });

                document.getElementById("nombre").value = "";
                document.getElementById("puesto").value = "";
                cargarEmpleados();
            } catch (error) {
                console.error("Error al agregar el empleado:", error);
            }
        }

        // Editar empleado
        function editarEmpleado(id, nombre, puesto) {
            const nuevoNombre = prompt("Nuevo nombre:", nombre);
            const nuevoPuesto = prompt("Nuevo puesto:", puesto);

            if (nuevoNombre && nuevoPuesto) {
                fetch(`${API_URL}/${id}`, {
                    method: "PUT",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ nombre: nuevoNombre, puesto: nuevoPuesto })
                }).then(cargarEmpleados);
            }
        }

        // Eliminar empleado
        async function eliminarEmpleado(id) {
            if (confirm("¿Seguro que deseas eliminar este empleado?")) {
                try {
                    await fetch(`${API_URL}/${id}`, { method: "DELETE" });
                    cargarEmpleados();
                } catch (error) {
                    console.error("Error al eliminar el empleado:", error);
                }
            }
        }

        // Cargar empleados al inicio
        document.addEventListener("DOMContentLoaded", cargarEmpleados);

        function handleLogout() {
            // Aquí puedes realizar las acciones para cerrar la sesión (ejemplo: borrar cookies o tokens)
            window.location.href = 'index.html';  // Cambia 'login.html' al nombre de tu página de login
        }
    </script>
</body>
</html>
